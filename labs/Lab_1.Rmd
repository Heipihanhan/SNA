---
title: "Lab_01_QMSSG4062"
author: "Jianghanhan Li"
date: "Feb 13, 2017"
output: html_document
---

#### 1. Develop a hypothesis about how some ego-network measure (e.g., degree/size, density, diversity, average-level of alters, homophily, structural holes, or brokerage) may be related to some other variable of interest. 

*Hypothesis* - Is happiness assocaited with the size of people's network ? Do happier people tend to have a bigger network? 


#### 2. Explain why you think these two variables should be related. 

```{r}
d <- read.csv("~/Dropbox/Columbia_QMSS/Spring2017/Social_Network_Analysis/Data/gss-nets.csv")
```


```{r}
library(gmodels)
CrossTable(d$numgiven, d$happy)
```

```{r}
library(gplots)
plotmeans(d$numgiven ~ d$happy, connect = T)
```


From the graph above we see an apprent downward trend between the two variables `happy` and `numgiven`. Note that `happy` was coded in a way as 1 means very happy and 3 means not very happy. So it seems the happier people are, the larger their size of network tend to be. We'll see more details in the regression analysis later. 


#### 3. Tell me about your variables. What is your dependent variable? What are your independent variables? How are they coded? How are they recoded? How are they calculated, if appropriate? 

Dependent varaible `numgiven` measures the number of people whom you discussed matters important to you. Name up to a maximum of 6 people. 
Independent variable `happy` measures the general happiness of a person. 1 Very happy. 2 Pretty happy. 3 Not too happy. 

I will also add other factors as a control mechanism: 
`age` measures age of respondent
`educ` measures the educational level 
`sex` measures sex of the respondent 
`realinc` measures family income in constant dollar

```{r}
# reverse coding for variable happy
d$happiness <- 4 - d$happy
# make a dummy variable for variable sex
d$gender <- ifelse(d$sex == 1, 1, 0) # Male 1, Female and other 0
```

```{r}
summary(d$age)
summary(d$educ)
```

#### 4. Present your initial results from your first few models. What do they indicate about your hypothesis? 

```{r}
lm1 <- lm(numgiven ~ happiness, data = d)
summary(lm1)
```

The coefficient of happiness is 0.122, (p value < 0.001). It shows a positive and significant relationship between `happy` and `numgiven`.  With 1 unit of increase in `happy`, people's network size increases by 0.122 on average. 

```{r}
lm2 <- lm(numgiven ~ happiness + age, data = d)
summary(lm2)
```

`age` also is a significant factor here. It seems the older people get, the smaller their network size. `happiness` is still significantly positively assocaited with `numgiven`. It's coefficient is 0.136 (p < 0.001). It shows that with each 1 unit of increase in `happiness`, peopel's network size increase by 0.136 on average, after controlling for `age`. 

```{r}
lm3 <- lm(numgiven ~ happiness + age + educ, data = d)
summary(lm3)
```

In this model, after accounting for `age` and `educ`, we see that `happiness` is still a significant factor (p < 0.05). With each 1 unit of increase in `happiness`, people's network size increases by 0.09 on average, all else held equal. 

The coefficient on `educ` is 0.112 (p < 0.001). Education is also a significant factor that's positively associated with people's network size. The higher the educaition level, the bigger their network size. 

```{r}
lm4 <- lm(numgiven ~ happiness + age + educ + gender, data = d)
summary(lm4)
```

In this model, after adding `gender`, we see that `happiness` is still a significant factor that's positively associated with `numgiven`. With each 1 unit of increase in `happiness`, people's network size increases by 0.088 on average, after controlling for age, education, gender. 

What's more, `gender` is a significant factor in affecting changes in `numgiven`. Being a male (`gender` == 1), decreases the network size by 0.14 on average, controlling for age, edcuation and happiness level. So males have less people whom they could talk to about matters important to them than females do. 


```{r}
lm5 <- lm(numgiven ~ happiness + age + educ + gender + realinc, data = d)
summary(lm5)
```

In this model, I added `realinc`, which changed the landscape completely. In this full model, `happiness` is no longer a significant factor, once considered age, education, gender and income altogether.

#### 5. Consider alternate specifications of your variables (i.e., recodings of various kinds). Consider interactions among your variables. 

```{r}
# recode income to make it more interpretable
d$realinc10k <- d$realinc/10000
lm6 <- lm(numgiven ~ happiness + age + educ + gender + realinc10k, data = d)
summary(lm6)
```

As we could see here, the coefficient of `realinc10k` is 0.06 (p < 0.001). With each  10000$ increase on the family income, the network size of people increases by 0.06 on average, all other factors held constant. 

In this case, `happiness` is coded as an ordinal variable, where 3 means very happy, 2 means pretty happy, and 1 means not too happy. The scale is quite small and the interval between each value is not exactly equal. So I'd like to recode it as a dummy variable `happiness_new`, with 1 happy, 0 not happy. 


```{r}
d$happiness_new <- ifelse(d$happiness == 1, 0, 1)
lm7 <- lm(numgiven ~ happiness_new + age + educ + gender + realinc10k, data = d)
summary(lm7)
```

Here, being happy will increase the network size by 0.063 on average than not happy, if all other factors were held constant, thought happiness is not a significant factor in this model still. 

#### 6. Give your best conclusion as to whether your initial hypothesis held up, and if not, why not. 

```{r}
lm8 <- lm(numgiven ~ happiness_new + age + educ + gender, data = d)
summary(lm8)
```

After removing `realinc10k`, `happiness_new` become slightly significant now. Being happy (`happiness_new` == 1) will increase the network size by 0.1167 on average, all else held equal. 

Overall, it seems that happiness positively affects the network size, but only to a certain degree. 
